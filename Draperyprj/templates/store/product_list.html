{% extends "base.html" %}
{% load static %}
{% block title %}Products{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/product-list-lite.css' %}">

{% if current_category %}
  <h1 class="h3 mb-3">{{ current_category }}</h1>
{% endif %}

<ul class="row list-unstyled g-3">
  {% for product in products %}
    <li class="col-6 col-md-4 col-lg-3">
      <a href="{{ product.get_absolute_url }}" class="card h-100 text-decoration-none text-reset product-card">
        <div class="ratio ratio-4x3">
          {% if product.product_image %}
            <img src="{{ product.product_image.url }}" alt="{{ product.product_name }}" class="img-fluid">
          {% elif product.image %}
            <img src="{{ product.image.url }}" alt="{{ product.product_name }}" class="img-fluid">
          {% else %}
            <img src="{% static 'images/placeholder.png' %}" alt="No image" class="img-fluid">
          {% endif %}
        </div>
        <div class="card-body p-2">
          <div class="product-name text-truncate">{{ product.product_name }}</div>
          <div class="product-price fw-semibold">â‚¬{{ product.price }}</div>
        </div>
      </a>
    </li>
  {% empty %}
    <li class="col-12"><p class="text-muted mb-0">No products.</p></li>
  {% endfor %}
</ul>

{# Optional: pagination support if you're using paginate_by #}
{% if is_paginated %}
  <nav class="mt-3" aria-label="Product pagination">
    <ul class="pagination pagination-sm mb-0">
      {% if page_obj.has_previous %}
        <li class="page-item">
          <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if current_category %}&category={{ current_category }}{% endif %}">Prev</a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">Prev</span></li>
      {% endif %}

      <li class="page-item disabled">
        <span class="page-link">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
      </li>

      {% if page_obj.has_next %}
        <li class="page-item">
          <a class="page-link" href="?page={{ page_obj.next_page_number }}{% if current_category %}&category={{ current_category }}{% endif %}">Next</a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">Next</span></li>
      {% endif %}
    </ul>
  </nav>
{% endif %}
{% endblock %}
